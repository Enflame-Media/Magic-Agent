# Happy Vue Web Application - Cloudflare Workers Configuration
#
# This deploys the Vue.js SPA to Cloudflare Workers using static assets.
# The [assets] section enables SPA routing where unmatched routes
# serve index.html for client-side routing to handle.

compatibility_date = "2026-01-01"
compatibility_flags = ["nodejs_compat"]
account_id = "81f483e6767ea3194467ecef42840f79"
# Use minimal worker entry that only serves assets (not the Vue app entry)
# The Vue app runs entirely in the browser after index.html is served
main = "src/worker.ts"

# Static assets configuration for SPA
# Vite builds to ./dist by default
[assets]
directory = "./dist"
binding = "ASSETS"
not_found_handling = "single-page-application"

#############################
# Development Environment
#############################
[env.development]
name = "happy-vue-web-dev"
workers_dev = false

[[env.development.routes]]
pattern = "app-dev.magicagent.app"
custom_domain = true

[env.development.observability]
[env.development.observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true

[env.development.vars]
ENVIRONMENT = "development"
BASE_URL = "https://app-dev.magicagent.app"
API_BASE_URL = "https://api-dev.magicagent.app"

#############################
# Production Environment
#############################
[env.production]
name = "happy-vue-web"
workers_dev = false

[[env.production.routes]]
pattern = "app.magicagent.app"
custom_domain = true

[env.production.observability]
[env.production.observability.logs]
enabled = true
head_sampling_rate = 0.1
invocation_logs = true

[env.production.vars]
ENVIRONMENT = "production"
BASE_URL = "https://app.magicagent.app"
API_BASE_URL = "https://api.magicagent.app"